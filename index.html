<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>QuickPolls</title>
  </head>
  <body>
    <h1>QuickPolls</h1>
    <p><span id="numParticipants"></span> participants</p>
    <div>
      <button data-value="a">A</button>
      <button data-value="b">B</button>
      <button data-value="c">C</button>
    </div>
    <p id="poll">A: 0, B: 0, C: 0</p>
    <script src="/socket.io/socket.io.js"></script>
    <script>
      const socket = io.connect('http://localhost:3000');
      const numParticipants = document.getElementById('numParticipants');
      const poll = document.getElementById('poll');
      const btns = Array.from(document.querySelectorAll('button'));
      
      socket.on('connected', data => {
        numParticipants.innerText = data.numParticipants;
        poll.innerText = `A: ${data.poll.a}, B: ${data.poll.b}, C: ${data.poll.c}`;
      });

      socket.on('disconnected', data => {
        numParticipants.innerText = data;
      })

      btns.forEach(btn => btn.addEventListener('click', e => {
        socket.emit('answer', e.target.dataset.value);
      }));

      socket.on('poll', data => {
        poll.innerText = `A: ${data.a}, B: ${data.b}, C: ${data.c}`;
      })
    </script>
  </body>
</html>